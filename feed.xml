<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title>Based And Pasted</title>
    <link href="https://m0n7y5.github.io/feed.xml" rel="self" />
    <link href="https://m0n7y5.github.io" />
    <updated>1970-01-01T01:00:00+01:00</updated>
    <author>
        <name>Admin</name>
    </author>
    <id>https://m0n7y5.github.io</id>

    <entry>
        <title>Beef DLL Creation &amp; Research</title>
        <author>
            <name>Admin</name>
        </author>
        <link href="https://m0n7y5.github.io/beef-dll-creation-and-research-2.html"/>
        <id>https://m0n7y5.github.io/beef-dll-creation-and-research-2.html</id>

        <updated>2020-09-02T12:14:47+02:00</updated>
            <summary>
                <![CDATA[
                     Beef language is still in heavy development. Anything and anytime can change in Beef language and thus this document may not be valid anymore! Beef is an open source performance-oriented compiled programming language. Basically it's C language with C# like syntax. OOP paradigm also&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                
  <p class="msg msg--warning">
    Beef language is still in heavy development. Anything and anytime can change in Beef language and thus this document may not be valid anymore!
  </p>

  <p>
    
  </p>

  <div class="post__toc">
    <h3>Content</h3>
    <ul>
      <li><a href="#requirementsnbspbr">Requirements&nbsp;<br></a></li><li><a href="#about-beefbr">About Beef<br></a></li><li><a href="#classic-dll-with-exported-methods">Classic DLL with exported methods</a></li><li><a href="#dll-with-dllmain">DLL with DllMain</a></li><li><a href="#how-to-work-with-threads-in-dll">How to work with threads in DLL</a></li>
    </ul>
  </div>
  

    <h2 id="requirementsnbspbr">
      Requirements&nbsp;<br>
    </h2>

  <ul>
    <li>Latest BeefIDE (nightly)
</li><li>DebugView++</li>
  </ul>

    <h2 id="about-beefbr">
      About Beef<br>
    </h2>

  <p>
    Beef is an open source performance-oriented compiled programming language. Basically it's C language with C# like syntax. OOP paradigm also can be used for developing applications since in Beef u can create custom reference types (Objects) and combine it with polymorphism. Reflection is also possible. Its quiet fast and its fun to work with. More info can be found here -&gt; https://www.beeflang.org/
  </p>

    <h2 id="classic-dll-with-exported-methods">
      Classic DLL with exported methods
    </h2>

  <p class="msg msg--info">
    Todo
  </p>

    <h2 id="dll-with-dllmain">
      DLL with DllMain
    </h2>

  <p>
    So first we need to create DLL project in Beef IDE. Go to File -&gt; New -&gt; New Project and choose Dynamic Library.
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://m0n7y5.github.io/media/posts/4/ProjectCreation.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://m0n7y5.github.io/media/posts/4/responsive/ProjectCreation-xs.png 300w ,https://m0n7y5.github.io/media/posts/4/responsive/ProjectCreation-sm.png 480w ,https://m0n7y5.github.io/media/posts/4/responsive/ProjectCreation-md.png 768w ,https://m0n7y5.github.io/media/posts/4/responsive/ProjectCreation-lg.png 1024w ,https://m0n7y5.github.io/media/posts/4/responsive/ProjectCreation-xl.png 1360w ,https://m0n7y5.github.io/media/posts/4/responsive/ProjectCreation-2xl.png 1600w"  height="282" width="372" alt="" />
      
    </figure>

  <p>
    Now we need to add new class called Program. Like this:
  </p>
<pre class="line-numbers  language-csharp"><code>namespace DLLResearch
{
	public static class Program
	{
	}
}</code></pre>

  <p>
    So... Normally when you are creating DLL (for example in C/++) you gonna define DllMain method which is gonna by called when some process gonna try to load our library using, for example, LoadLibrary function from Win32 API. However, this is not possible in Beef since DllMain is already handled by Beef Runtime.
<br>
<br>So what we gonna do now? ðŸ¤” It turns out that solution is very simple. Only thing we need to do is write public static constructor and deconstructor for class Program.
  </p>
<pre class="line-numbers  language-csharp"><code>using System.Diagnostics;
using System;
namespace DLLResearch
{
    [AlwaysInclude] // &lt;- We need this to include our class in DLL, Normally u dont need this
	public static class Program
	{
		public static this() // &lt;- This will gets called when our library gets loaded
		{
			Debug.WriteLine("Hello From Beef DLL :3");
		}

		public static ~this() // &lt;- This will gets called when our library gets unloaded
		{
			Debug.WriteLine("See ya next time my friend :)");
		}
	}
}</code></pre>

  <p>
    So lets compile it and inject it into some process. I am gonna use notepad.
<br>As u can see, when we inject our library into notepad we can see this in DebugView++.<br>
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://m0n7y5.github.io/media/posts/4/Loaded1.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://m0n7y5.github.io/media/posts/4/responsive/Loaded1-xs.png 300w ,https://m0n7y5.github.io/media/posts/4/responsive/Loaded1-sm.png 480w ,https://m0n7y5.github.io/media/posts/4/responsive/Loaded1-md.png 768w ,https://m0n7y5.github.io/media/posts/4/responsive/Loaded1-lg.png 1024w ,https://m0n7y5.github.io/media/posts/4/responsive/Loaded1-xl.png 1360w ,https://m0n7y5.github.io/media/posts/4/responsive/Loaded1-2xl.png 1600w"  height="130" width="701" alt="" />
      
    </figure>

  <p>
    Our constructor get called and we printed first message. So lets try to unload our library and lets see what happens.&nbsp;<br>
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://m0n7y5.github.io/media/posts/4/Unloaded1.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://m0n7y5.github.io/media/posts/4/responsive/Unloaded1-xs.png 300w ,https://m0n7y5.github.io/media/posts/4/responsive/Unloaded1-sm.png 480w ,https://m0n7y5.github.io/media/posts/4/responsive/Unloaded1-md.png 768w ,https://m0n7y5.github.io/media/posts/4/responsive/Unloaded1-lg.png 1024w ,https://m0n7y5.github.io/media/posts/4/responsive/Unloaded1-xl.png 1360w ,https://m0n7y5.github.io/media/posts/4/responsive/Unloaded1-2xl.png 1600w"  height="142" width="686" alt="" />
      
    </figure>

  <p>
    Looks like our deconstructor gets also called.<br>
  </p>

  <p class="msg msg--highlight">
    Note: Our deconstructor also gets called when process, where our library is loaded, gonna exit.
<br>
  </p>

    <h2 id="how-to-work-with-threads-in-dll">
      How to work with threads in DLL
    </h2>

  <p class="msg msg--info">
    Todo
  </p>
            ]]>
        </content>
    </entry>
</feed>
